# Semantic Routing Code Assistant (SRCA)

ä¸€ä¸ªä¸ºå¤šè¯­è¨€ä»£ç æ„å»ºè½»é‡è¯­ä¹‰ç´¢å¼•çš„ VS Code æ‰©å±•ï¼Œè®© LLM æç¤ºè¯æ›´çŸ­ã€æ›´å‡†ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **å¤šè¯­è¨€æ”¯æŒ**ï¼šè‡ªåŠ¨è¯†åˆ«å¹¶ç´¢å¼• C/C++ã€Javaã€JavaScript/TypeScriptã€Vueã€Pythonã€Go ä»£ç 
- **æ™ºèƒ½æ ‡ç­¾**ï¼šåŸºäºè§„åˆ™çš„åŸºç¡€æ ‡ç­¾ + LLM ç”Ÿæˆçš„è¯­ä¹‰æ ‡ç­¾
- **æ ‡ç­¾å›¾è°±**ï¼šå¯è§†åŒ–çš„ Canvas 2D æ°”æ³¡å›¾ï¼Œæ”¯æŒæ‹–æ‹½/ç¼©æ”¾ã€ç­›é€‰ä¸è·³è½¬
- **å¢é‡æ›´æ–°**ï¼šé€šè¿‡æ–‡ä»¶ hash ç¼“å­˜ï¼Œä»…æ›´æ–°ä¿®æ”¹çš„æ–‡ä»¶
- **å¯æ‰©å±•æ¶æ„**ï¼šè¯­è¨€é€‚é…å™¨å±‚è®¾è®¡ï¼Œè½»æ¾æ·»åŠ æ–°è¯­è¨€æ”¯æŒ

---

## ğŸ“‚ ç›®å½•ç»“æ„

```
semantic-route-assistant/
â”œâ”€â”€ core/                    # Node/TypeScript æ ¸å¿ƒå¼•æ“
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ language/        # è¯­è¨€é€‚é…å™¨
â”‚       â”‚   â”œâ”€â”€ cppAdapter.ts
â”‚       â”‚   â”œâ”€â”€ javaAdapter.ts
â”‚       â”‚   â”œâ”€â”€ jsAdapter.ts
â”‚       â”‚   â”œâ”€â”€ pythonAdapter.ts
â”‚       â”‚   â””â”€â”€ goAdapter.ts
â”‚       â”œâ”€â”€ indexV3.ts       # V3 ç´¢å¼•æ„å»ºä¸»é€»è¾‘
â”‚       â””â”€â”€ ...
â”œâ”€â”€ vscode-extension/        # VS Code æ‰©å±•
â”œâ”€â”€ examples/                # ç¤ºä¾‹é¡¹ç›®
â”œâ”€â”€ docs/                    # è®¾è®¡æ–‡æ¡£
â””â”€â”€ scripts/                 # å¼€å‘è„šæœ¬
```

---

## ğŸŒ æ”¯æŒçš„è¯­è¨€

| è¯­è¨€ | æ–‡ä»¶æ‰©å±•å | ç¬¦å·æå– | æ ‡ç­¾æ¨æ–­ |
|------|-----------|---------|---------|
| **C/C++** | `.c`, `.cpp`, `.cc`, `.cxx`, `.h`, `.hpp`, `.hxx`, `.hh` | tree-sitter | class/struct, ç»§æ‰¿, å‘½åç©ºé—´ |
| **Java** | `.java` | æ­£åˆ™ | class/interface/enum, extends/implements, æ³¨è§£ |
| **JavaScript/TypeScript** | `.js`, `.jsx`, `.ts`, `.tsx`, `.mjs`, `.cjs` | æ­£åˆ™ | class/function, async/export, è£…é¥°å™¨ |
| **Vue** | `.vue` | æ­£åˆ™ | component, è£…é¥°å™¨ |
| **Python** | `.py`, `.pyw` | æ­£åˆ™ | class/def, async, è£…é¥°å™¨, ç»§æ‰¿ |
| **Go** | `.go` | æ­£åˆ™ | func/struct/interface, receiver, exported |

---

## ğŸš€ VS Code æŒ‡ä»¤

| æŒ‡ä»¤ | è¯´æ˜ |
|------|------|
| `Semantic Route: Build Index` | å…¨é‡æ„å»ºç´¢å¼• |
| `Semantic Route: Update Index` | å¢é‡æ›´æ–°ç´¢å¼• |
| `Semantic Route: Search Skill Blocks` | æœç´¢æŠ€èƒ½å—ï¼ˆæ”¯æŒ `#tag` è¿‡æ»¤ï¼‰ |
| `Semantic Route: Tag Graph` | æ‰“å¼€æ ‡ç­¾æ°”æ³¡å›¾ |
| `Semantic Route: Configure LLM` | é…ç½® LLM æä¾›å•† |
| `Semantic Route: Auto Skills (Doc/Clipboard)` | è‡ªåŠ¨ç”ŸæˆæŠ€èƒ½æ–‡æ¡£ |

---

## ğŸ“¦ ç´¢å¼•äº§ç‰©

ç´¢å¼•è¾“å‡ºåˆ°é¡¹ç›®æ ¹ç›®å½•çš„ `.ai_context/` æ–‡ä»¶å¤¹ï¼š

```
.ai_context/
â”œâ”€â”€ modules/           # æ¨¡å—çº§ Markdown æ–‡ä»¶
â”‚   â”œâ”€â”€ Item.md
â”‚   â”œâ”€â”€ Service.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ routing.json       # ç¬¦å·è·¯ç”±è¡¨
â””â”€â”€ .meta.json         # æ–‡ä»¶ hash ç¼“å­˜
```

### æ¨¡å—æ–‡ä»¶æ ¼å¼ç¤ºä¾‹

```markdown
# Module: Item

> å›¾å½¢é¡¹ç›¸å…³çš„ç±»å’Œæ–¹æ³•

## APIs

- `class LineItem : public BaseItem` <!-- id: Item::LineItem | hash: xxx | file: client/src/Item/line_item.h | tags_base: [item, line, class, baseitem] | tags_sem: [å›¾å½¢, è¿æ¥çº¿] -->
  çº¿æ¡å›¾å½¢é¡¹ï¼Œè¿æ¥ä¸¤ä¸ªçŸ©å½¢

- `void RectItem::addLine(LineItem* line)` <!-- id: Item::RectItem::addLine | hash: xxx | file: client/src/Item/rect_item.cpp | tags_base: [item, rect, add, line, rectitem] | tags_sem: [é›†åˆå­˜å‚¨, å¯¹è±¡å…³è”] -->
  å‘çŸ©å½¢é¡¹æ·»åŠ çº¿æ¡
```

---

## ğŸ”§ æ ‡ç­¾ç³»ç»Ÿ

### åŸºç¡€æ ‡ç­¾ (tags_base)
é€šè¿‡è§„åˆ™è‡ªåŠ¨æ¨æ–­ï¼Œä¸ç»è¿‡ LLMï¼š

- **è·¯å¾„åˆ†è¯**ï¼š`client/src/Item/rect_item.cpp` â†’ `item`, `rect`
- **ç¬¦å· ID åˆ†è¯**ï¼š`RectItem::addLine` â†’ `rect`, `add`, `line`
- **ç±»å‹æ ‡ç­¾**ï¼š`class`ã€`struct`ã€`interface`ã€`function`
- **ç»§æ‰¿å…³ç³»**ï¼šçˆ¶ç±»åä½œä¸ºæ ‡ç­¾
- **è¯­è¨€ç‰¹å®š**ï¼š
  - Java: æ³¨è§£åã€extends/implements
  - Python: è£…é¥°å™¨å
  - Go: exported, method, receiver ç±»å‹

### è¯­ä¹‰æ ‡ç­¾ (tags_sem)
é€šè¿‡ LLM ç”Ÿæˆï¼Œæè¿°åŠŸèƒ½è¯­ä¹‰ï¼š

- è‡ªåŠ¨è¿‡æ»¤ä¸åŸºç¡€æ ‡ç­¾é‡å¤çš„å†…å®¹
- æœ€å¤šä¿ç•™ 5 ä¸ªé«˜ä¿¡æ¯é‡æ ‡ç­¾
- ç¤ºä¾‹ï¼š`[é›†åˆå­˜å‚¨, æ— é‡å¤æ’å…¥, å¯¹è±¡å…³è”]`

---

## âš™ï¸ LLM é…ç½®

é€šè¿‡ `Semantic Route: Configure LLM` å‘½ä»¤é…ç½®ï¼š

| æä¾›å•† | æ”¯æŒçš„æ¨¡å‹ |
|--------|-----------|
| OpenAI | gpt-4o-mini, gpt-4.1-mini, gpt-4o |
| Qwen | qwen-flash, qwen-turbo, qwen-plus, qwen-max |
| Gemini | gemini-1.5-flash, gemini-1.5-pro |
| Other | è‡ªå®šä¹‰ baseUrl å’Œæ¨¡å‹ |

### Prompt å ä½ç¬¦

| å ä½ç¬¦ | è¯´æ˜ |
|--------|------|
| `{{moduleName}}` | æ¨¡å—å |
| `{{signature}}` | å‡½æ•°/ç±»ç­¾å |
| `{{implementation}}` | å‡½æ•°å®ç°ä»£ç  |

### ç›¸å…³è®¾ç½®

```json
{
  "semanticRoute.llm.profiles": [],
  "semanticRoute.llm.activeProfile": "",
  "semanticRoute.llm.enabled": true,
  "semanticRoute.llm.briefConcurrency": 4,
  "semanticRoute.skills.autoTopN": 8
}
```

---

## ğŸ› ï¸ æ‰©å±•æ–°è¯­è¨€

1. åœ¨ `core/src/language/` åˆ›å»ºæ ‡ç­¾æ¨æ–­æ–‡ä»¶å’Œé€‚é…å™¨ï¼š

```typescript
// newLangTags.ts
export function inferNewLangBaseTags(input: BaseTagsInput): string[] {
  // è¯­è¨€ç‰¹å®šçš„æ ‡ç­¾æ¨æ–­é€»è¾‘
}

// newLangAdapter.ts
export const newLangAdapter: LanguageAdapter = {
  id: "newlang",
  displayName: "New Language",
  fileExtensions: ["nl", "newlang"],
  scanSourceFiles: createScanner(["**/*.nl"]),
  extractSymbolsFromCode,
  extractImplementationFromCode,
  extractImplementationForSymbol,
  inferPathModuleHint: inferPathModuleHintGeneric,
  inferBaseTags: inferNewLangBaseTags
};
```

2. åœ¨ `core/src/language/index.ts` æ³¨å†Œï¼š

```typescript
import { newLangAdapter } from "./newLangAdapter";
registerLanguageAdapter(newLangAdapter);
```

3. é‡æ–°ç¼–è¯‘ï¼š

```bash
cd core && npm run build
```

---

## ğŸ”¨ å¼€å‘

### æ„å»º

```bash
# æ„å»º core
cd core && npm run build

# æ„å»º VS Code æ‰©å±•
cd vscode-extension && npm run compile

# ä¸€é”®é‡å»º
./scripts/rebuild.sh
```

### æ‰“åŒ…æ‰©å±•

```bash
cd vscode-extension
npx vsce package
```

---

## ğŸ“‹ æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        VS Code Extension                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Commands: Build/Update/Search/TagGraph/ConfigureLLM    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Core Engine (indexV3)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ scanAllFiles   â”‚â†’ â”‚ extractSymbols â”‚â†’ â”‚ inferBaseTags   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                  â”‚                    â”‚              â”‚
â”‚           â–¼                  â–¼                    â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              Language Adapter Layer                     â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”            â”‚     â”‚
â”‚  â”‚  â”‚ C++ â”‚ â”‚ Java â”‚ â”‚ JS â”‚ â”‚ Python â”‚ â”‚ Go â”‚            â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚                                                      â”‚
â”‚           â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ LLM Brief/Tags  â”‚â†’ â”‚ Module Grouping â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚           â”‚                    â”‚                                 â”‚
â”‚           â–¼                    â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Output: .ai_context/modules/*.md + routing.json       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å¤‡æ³¨

- Build/Update é»˜è®¤ä½¿ç”¨ V3 ç®¡çº¿ï¼Œè¾“å‡ºåˆ° `.ai_context/`
- V1/V2 é€»è¾‘ä¿ç•™åœ¨ core å†…éƒ¨ï¼Œä½†ä¸å†æš´éœ²ä¸ºå‘½ä»¤
- C/C++ ä½¿ç”¨ tree-sitter è¿›è¡Œç²¾ç¡®è§£æï¼Œå…¶ä»–è¯­è¨€ä½¿ç”¨æ­£åˆ™æå–ï¼ˆåç»­å¯å‡çº§ï¼‰

---

## License

MIT
